# 新的三区域布局系统

## 概述

根据用户需求，采用类似 ChatGPT 和 Cursor 的设计风格，将布局重新设计为三个区域：
1. **最左侧**：竖向功能导航栏（类似 ChatGPT 的侧边栏）
2. **中间**：多对话窗口管理面板（横向选项卡，类似浏览器标签页）
3. **右侧**：简历编辑器

## 新的布局结构

```
┌────┬──────────────────────┬──────────────────────────────┐
│    │                      │                              │
│ 竖  │  对话管理面板         │      简历编辑器               │
│ 向  │  ┌────┬────┬────┐   │                              │
│ 导  │  │对话1│对话2│ + │   │                              │
│ 航  │  └────┴────┴────┘   │                              │
│ 栏  │                      │                              │
│    │  ┌────────────────┐  │                              │
│ AI │  │                │  │                              │
│ 工 │  │   聊天内容     │  │        A4 编辑区域            │
│ 作 │  │   或扩展UI     │  │                              │
│ 流 │  │                │  │                              │
│    │  └────────────────┘  │                              │
│ 公 │                      │                              │
│ 司 │  ┌────────────────┐  │                              │
│ /  │  │ 模型: GPT-4 ▼ │  │                              │
│ 岗 │  └────────────────┘  │                              │
│ 位 │                      │                              │
│    │                      │                              │
│ 建 │                      │                              │
│ 议 │                      │                              │
│    │                      │                              │
│ 学 │                      │                              │
│ 习 │                      │                              │
│    │                      │                              │
│ 面 │                      │                              │
│ 试 │                      │                              │
│    │                      │                              │
│────│                      │                              │
│ +  │                      │                              │
│ ⚙  │                      │                              │
└────┴──────────────────────┴──────────────────────────────┘
```

## 核心组件

### 1. VerticalNavBar
**文件**: `apps/web/src/components/layout/VerticalNavBar.tsx`

**功能**:
- 竖向功能导航栏，类似 ChatGPT 左侧栏
- 支持展开/收起（展开: 240px，收起: 64px）
- 底部固定"新建对话"和"设置"按钮

**导航项**:
1. **AI 工作流** - 简历上传、管理等基础操作
2. **公司/岗位** - JD 解析和岗位匹配
3. **建议** - AI 生成的简历优化建议（带徽章提示）
4. **学习** - 学习资源推荐
5. **面试** - 面试准备和模拟（带徽章提示）

**Props**:
- `activeItem`: 当前激活的功能项
- `onItemChange`: 功能项切换回调
- `collapsed`: 是否收起
- `onToggleCollapse`: 展开/收起切换回调

### 2. MultiChatPanel
**文件**: `apps/web/src/components/layout/MultiChatPanel.tsx`

**功能**:
- 多对话窗口管理（类似浏览器标签页或 Cursor 的多对话）
- 横向选项卡切换不同对话会话
- 每个对话会话独立的上下文
- 支持新建、关闭对话会话

**主要区域**:
1. **顶部选项卡栏**:
   - 显示所有对话会话（对话 1、对话 2...）
   - 每个选项卡可以关闭（至少保留一个）
   - "+" 按钮快速新建对话
   - 横向滚动支持多个对话

2. **主内容区**:
   - 根据选中的功能显示对应的扩展 UI
   - 或显示 SmartChatInterface 聊天界面
   - 支持垂直滚动

3. **底部操作栏**:
   - 模型选择下拉菜单（GPT-4, GPT-3.5, Claude-3, Gemini）

**Props**:
- `activeFunction`: 当前激活的功能（来自左侧导航栏）
- `width`: 面板宽度（可调整）
- `onResize`: 宽度调整回调
- `onClose`: 关闭面板回调
- `extensions`: 扩展列表
- `extensionProps`: 扩展组件的 props
- `appContext`: 应用上下文

### 3. TwoColumnLayout
**文件**: `apps/web/src/components/layout/TwoColumnLayout.tsx`

**功能**:
- 协调三个区域的布局和交互
- 管理全局应用状态（resume, jd, target 等）
- 处理面板显示/隐藏和宽度调整

**布局逻辑**:
```
总宽度 = 导航栏宽度 + 对话面板宽度 + 编辑器宽度

导航栏宽度 = collapsed ? 64px : 240px
对话面板宽度 = 320px - 700px（可调整）
编辑器宽度 = 剩余空间（自适应）
```

## 对话会话管理

### 会话数据结构
```typescript
interface ChatSession {
  id: string;           // 唯一标识
  title: string;        // 显示标题（对话 1, 对话 2...）
  type: string;         // 所属功能类型（workflow, company, suggestions等）
  timestamp: Date;      // 创建时间
}
```

### 会话操作
1. **新建对话**: 点击选项卡栏的 "+" 按钮
2. **切换对话**: 点击对应的选项卡
3. **关闭对话**: 悬停时显示关闭按钮（至少保留一个对话）
4. **自动切换**: 关闭当前对话时自动切换到第一个对话

### 会话特点
- 每个对话独立的上下文和历史
- 对话会话与功能类型关联
- 支持在同一功能下创建多个对话
- 横向滚动支持大量对话会话

## 三区域交互

### 1. 左侧导航栏 → 中间对话面板
- 切换导航栏中的功能项
- 对话面板显示对应功能的 UI 或聊天界面
- 对话会话保持独立（每个功能有自己的对话列表）

### 2. 中间对话面板 → 右侧编辑器
- 通过 `appContext` 传递数据
- 支持简历导入、内容更新
- 选中文本可传递给对话面板

### 3. 右侧编辑器 → 中间对话面板
- 选中的文本传递给聊天界面
- 用于智能优化和建议生成

## 特性

### 1. 可调整宽度
- **导航栏**: 64px（收起）/ 240px（展开）
- **对话面板**: 320px - 700px（拖拽调整）
- **编辑器**: 自适应剩余空间

### 2. 可折叠
- 导航栏支持展开/收起切换
- 对话面板可以完全隐藏
- 隐藏时显示展开按钮

### 3. 徽章提示
- 导航栏项可显示徽章（如未读建议数、待完成任务数）
- 自动显示数字或自定义内容

### 4. 响应式设计
- 自动适应不同屏幕尺寸
- 平滑的过渡动画
- 自定义滚动条样式

## 设计参考

### ChatGPT 风格
- ✅ 左侧竖向导航栏
- ✅ 图标 + 文字的导航项
- ✅ 底部固定操作按钮
- ✅ 展开/收起功能

### Cursor 风格  
- ✅ 多对话窗口管理
- ✅ 横向选项卡切换
- ✅ 独立的对话上下文
- ✅ 扩展功能集成

## 与之前布局的对比

### 之前的两栏布局
- 左侧：集成边栏（选项卡 + 内容）
- 右侧：编辑器

### 现在的三区域布局
- 最左：竖向功能导航
- 中间：对话管理面板
- 右侧：编辑器

### 优势
1. **更清晰的功能分离**: 导航、对话、编辑各司其职
2. **更强的扩展性**: 多对话支持不同场景的并行工作
3. **更好的用户体验**: 符合现代 AI 工具的使用习惯
4. **更灵活的空间管理**: 三个区域独立调整

## 使用方法

在编辑器页面中使用：

```tsx
import { TwoColumnLayout } from '@/components/layout/TwoColumnLayout';

<TwoColumnLayout
  resumeContent={resumeContent}
  onResumeChange={handleResumeChange}
  onSelectionChange={handleSelectionChange}
  onEditorReady={handleEditorReady}
  onResumeImported={() => setUploaded(true)}
/>
```

## 样式说明

### 自定义滚动条
- 使用 `custom-scrollbar` 类
- 蓝色渐变主题
- 宽度: 8px
- 圆角设计

### 颜色系统
- 主色: `#3330E4` (深蓝)
- 辅助色: `#6B5CE8` (紫蓝)
- 激活态: 蓝色背景 + 边框
- 悬停态: 灰色背景

### 动画效果
- 宽度调整: 300ms ease
- 展开/收起: 300ms ease
- 按钮悬停: 200ms ease

## 未来扩展

可以考虑添加的功能：
1. **对话历史持久化**: 保存对话记录到本地或云端
2. **对话搜索**: 在多个对话中搜索内容
3. **对话分组**: 按项目或目标对对话进行分组
4. **快捷键支持**: 
   - Cmd/Ctrl + 数字键切换功能
   - Cmd/Ctrl + T 新建对话
   - Cmd/Ctrl + W 关闭当前对话
5. **对话重命名**: 自定义对话标题
6. **对话导出**: 导出对话记录为 Markdown 或 PDF
7. **多模态输入**: 支持截图、语音等输入方式
